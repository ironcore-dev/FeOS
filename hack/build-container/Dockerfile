FROM rust:1-bookworm

RUN apt-get update && apt-get upgrade -y && apt-get install -y \
    flex bison bc libelf-dev \
    cpio zstd \
    gperf \
    ninja-build \
    protobuf-compiler \
    libprotobuf-dev \
    sbsigntool systemd-boot \
    musl-tools \
    ca-certificates \
    binutils

RUN cargo new xyz; cd xyz; cargo fetch; cd ..; rm -rf xyz
RUN rustup component add clippy
RUN rustup component add rustfmt
RUN rustup target add x86_64-unknown-linux-musl
RUN mkdir /feos
RUN mkdir /target
WORKDIR /feos
